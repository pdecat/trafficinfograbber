<!--
  %%Ignore-License
  -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0 plus SVG 1.1//EN" "http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg.dtd">
<html lang="fr" xml:lang="fr" xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Sytadin : l'état du trafic en Île-de-France en temps réel</title>
        <base href="http://www.sytadin.fr">
        <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
        <meta name="viewport" content="initial-scale=2.0, target-densitydpi=device-dpi, width=device-width" />
        
        <link type="text/css" rel="stylesheet" href="/resources/css/sytadin2.css">
        <link type="text/css" rel="stylesheet" href="/resources/css/sytadin-gp.css">
        <link type="text/css" rel="stylesheet" href="/resources/css/jquery-ui.css">
        <link type="text/css" rel="stylesheet" href="/resources/js/theme/default/style.css">
        <style type="text/css">
            #map{
                padding: 0;
                background: rgba(0, 0, 0, 0);
                border: none;
            }
        </style>
    </head>

    <body onload="construct();">
        <div id="global">   
                <div id="content">                  
                    <div class="main_block">
                        <div class="" id="map" style="height: 800px;">
                            <script src="/resources/js/jquery.min.js" type="text/javascript"></script>                  
                            <script src="/resources/js/sytadin.js" type="text/javascript"></script>         
                            <script src="/resources/js/jquery.tablesorter.js" type="text/javascript"></script>
                            <script src="/resources/js/OpenLayers.js" type="text/javascript"></script>
                            <script src="/resources/js/toolsBarTpsReel.js" type="text/javascript"></script>
                            <script src="/resources/js/cartesTempsReel-gp.js" type="text/javascript"></script>                      
                            <script type="text/javascript">
                                var jsonProxy = 'http://tig.decat.org/jsonProxy.php?uri=';
                                (function() {
                                    var proxied = window.XMLHttpRequest.prototype.open;
                                    window.XMLHttpRequest.prototype.open = function() {
                                        arguments[1] = jsonProxy + arguments[1].substring(1) 
                                        return proxied.apply(this, arguments);
                                    };
                                })();
                                (function() {
                                    getPageHeight = function() {
                                        return window.innerHeight;
                                    };
                                })();
                                (function() {
                                    getPageWidth = function() {
                                        return window.innerWidth;
                                    };
                                })();

                                (function() {
                                    construct = function() {
                                        var divMap = document.getElementById('map');
                                        if(divMap) {
                                            divMap.style.height = getPageHeight() + "px";
                                            divMap.style.width = getPageWidth() + "px";
                                        }
                                        updateMap();
                                    };
                                })();

                                (function() {
                                    updateMap = function() {
                                        if(typeof(map) != undefined) {
                                            map.updateSize();
                                            // position bar zoom
                                            px = new OpenLayers.Pixel(map.div.clientWidth - 50, map.div.clientHeight / 2 - 100);
                                            zoomBarControl.moveTo(px);
                                        }
                                    };
                                })();
                                window.setTimeout(function() {
                                    init();
                                    $("#saveFavoriteView").parent().remove()
                                    $("#loadFavoriteView").parent().remove()
                                }, 100);
                            </script>
                        </div>
                    </div>
                </div>
            </div>        
        </div>
        <script type="text/javascript">
            // Override window.alert
            function tigShowAndroidToast(toast) {
                try {
                    TIGAndroid.showToast(toast);
                    console.info("tigShowAndroidToast: lastModText=" + lastModText);
                } catch(err) {
                    console.error("tigShowAndroidToast: " + err);
                }
            }
            
            try {
                (function() {
                    window.alert = function() {
                    TIGAndroid.showToast(arguments[0]);
                    return false;
                  };
                })();
            } catch(err) {
                console.error(err);
            }
            
            // Last modified information extraction
            function tigUpdateLastModified() {
                try {
                    var lastModText = jQuery("#dateReseauControl").text().substring(21).split(" à ").join("\n"); 
                    console.info("tigUpdateLastModified: lastModText=" + lastModText);
                    TIGAndroid.updateLastModified(lastModText);
                } catch(err) {
                    console.error("tigUpdateLastModified: " + err);
                }
            }

            window.setTimeout(function() {
                try {
                    // Call tigUpdateLastModified once and register it for updates
                    tigUpdateLastModified();
                    jQuery("#dateReseauControl").bind('DOMSubtreeModified', tigUpdateLastModified);
                } catch(err) {
                    console.error(err);
                }
            }, 150);
        </script>
        <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
        </script>
        <script type="text/javascript">
            try {
                var pageTracker = _gat._getTracker("UA-8749317-5");
                pageTracker._trackPageview();
            } catch(err) {}
    </script>
  </body>
</html>
